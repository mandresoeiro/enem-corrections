{% extends "dashboard/base.html" %}
{% block title %}Gerenciar Usuários — ENEM Corrections{% endblock %}
{% block header %}Gerenciamento de Usuários{% endblock %}

{% block content %}

<!-- ===== FILTROS ===== -->
<div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">

  <!-- Buscar -->
  <input type="text" placeholder="Buscar usuário por nome ou email..."
    class="px-4 py-2 rounded-lg bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 w-full md:w-72" />

  <!-- Filtros -->
  <div class="flex gap-3">
    <select class="px-3 py-2 rounded-lg bg-white dark:bg-gray-800 border dark:border-gray-700">
      <option>Role: Todos</option>
      <option>Aluno</option>
      <option>Professor</option>
      <option>Admin</option>
    </select>

    <select class="px-3 py-2 rounded-lg bg-white dark:bg-gray-800 border dark:border-gray-700">
      <option>Status: Todos</option>
      <option>Ativo</option>
      <option>Bloqueado</option>
    </select>
  </div>

</div>


<!-- ===== TABELA ===== -->
<div class="bg-white dark:bg-gray-800 rounded-xl shadow border border-gray-200 dark:border-gray-700 overflow-hidden">

  <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">

    <thead class="bg-gray-50 dark:bg-gray-700/50">
      <tr>
        <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase">Usuário</th>
        <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase">Email</th>
        <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase">Role</th>
        <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase">Status</th>
        <th class="px-6 py-3"></th>
      </tr>
    </thead>

    <tbody class="divide-y divide-gray-200 dark:divide-gray-700 bg-white dark:bg-gray-800">

      {% for user in users %}

      <tr class="hover:bg-gray-50 dark:hover:bg-gray-700/40 transition">

        <!-- Usuário + Avatar -->
        <td class="px-6 py-4 whitespace-nowrap">
          <div class="flex items-center gap-3">

            <div
              class="w-10 h-10 rounded-full bg-emerald-600 flex items-center justify-center text-white font-semibold uppercase">
              {{ user.username|first }}
            </div>

            <span class="font-medium text-gray-900 dark:text-gray-100">
              {{ user.username }}
            </span>
          </div>
        </td>

        <!-- Email -->
        <td class="px-6 py-4 text-sm text-gray-700 dark:text-gray-300">
          {{ user.email }}
        </td>

        <!-- Role -->
        <td class="px-6 py-4">
          {% if user.role == "student" %}
          <span
            class="px-2 py-1 rounded text-xs bg-blue-200 dark:bg-blue-600 text-blue-900 dark:text-blue-100">Aluno</span>

          {% elif user.role == "teacher" %}
          <span
            class="px-2 py-1 rounded text-xs bg-purple-200 dark:bg-purple-600 text-purple-900 dark:text-purple-100">Professor</span>

          {% elif user.role == "admin" %}
          <span
            class="px-2 py-1 rounded text-xs bg-emerald-200 dark:bg-emerald-600 text-emerald-900 dark:text-emerald-100">Admin</span>
          {% endif %}
        </td>

        <!-- Status -->
        <td class="px-6 py-4">
          {% if user.is_active %}
          <span
            class="px-2 py-1 rounded text-xs bg-emerald-200 dark:bg-emerald-600 text-emerald-900 dark:text-emerald-100">Ativo</span>
          {% else %}
          <span
            class="px-2 py-1 rounded text-xs bg-red-200 dark:bg-red-600 text-red-900 dark:text-red-100">Bloqueado</span>
          {% endif %}
        </td>

        <!-- Ações -->
        <td class="px-6 py-4 text-right whitespace-nowrap">

          <!-- Ver perfil -->
          <a href="/admin/users/{{ user.id }}/"
            class="px-3 py-1 text-sm bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600 transition">
            Ver
          </a>

          <!-- Editar -->
          <a href="/admin/users/{{ user.id }}/edit/"
            class="px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition">
            Editar
          </a>

          <!-- Bloquear -->
          <a href="/admin/users/{{ user.id }}/block/"
            class="px-3 py-1 text-sm bg-yellow-500 text-white rounded hover:bg-yellow-600 transition">
            Bloquear
          </a>

          <!-- Remover -->
          <a href="/admin/users/{{ user.id }}/delete/"
            class="px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition">
            Excluir
          </a>

        </td>

      </tr>

      {% endfor %}

    </tbody>
  </table>

</div>

{% endblock %}