<!-- TOPBAR PRO -->
<header class="w-full bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700
         px-6 py-4 flex items-center justify-between">

  <!-- ================= LADO ESQUERDO ================= -->
  <div class="flex items-center gap-4">

    <!-- BotÃ£o Mobile para abrir sidebar -->
    <button @click="sidebarOpen = true" class="lg:hidden text-2xl text-gray-700 dark:text-gray-200">
      â˜°
    </button>

    <!-- TÃ­tulo da pÃ¡gina dinÃ¢mico -->
    <h1 class="text-xl font-bold tracking-tight">
      {% block header %}{% endblock %}
    </h1>
  </div>


  <!-- ================= LADO DIREITO ================= -->
  <div class="flex items-center gap-6">

    <!-- =============== BUSCA GLOBAL =============== -->
    <div class="hidden md:flex items-center bg-gray-100 dark:bg-gray-800 px-3 py-2 rounded-lg w-64">
      <span class="text-gray-500 dark:text-gray-300">ğŸ”</span>
      <input type="text" placeholder="Buscar..." class="bg-transparent border-none focus:ring-0 outline-none text-sm ml-2 w-full
                    text-gray-700 dark:text-gray-200">
    </div>

    <!-- =============== NOTIFICAÃ‡Ã•ES =============== -->
    <div x-data="{ open: false }" class="relative">

      <button @click="open = !open"
        class="relative text-2xl text-gray-700 dark:text-gray-200 hover:opacity-80 transition">
        ğŸ””

        <!-- Badge -->
        {% if notifications_count > 0 %}
        <span class="absolute -top-1 -right-1 bg-red-600 text-white text-xs rounded-full px-1.5 py-0.5">
          {{ notifications_count }}
        </span>
        {% endif %}
      </button>

      <!-- Dropdown -->
      <div x-show="open" @click.outside="open = false" x-transition
        class="absolute right-0 mt-3 w-72 bg-white dark:bg-gray-800 shadow-lg border border-gray-200 dark:border-gray-700 rounded-lg p-4 z-50">

        <h3 class="text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3">NotificaÃ§Ãµes</h3>

        {% if notifications %}
        <ul class="space-y-2 max-h-60 overflow-y-auto">
          {% for note in notifications %}
          <li class="text-sm text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 p-2 rounded-lg">
            {{ note.message }}
            <span class="text-xs block text-gray-500">{{ note.created_at|date:"d/m H:i" }}</span>
          </li>
          {% endfor %}
        </ul>
        {% else %}
        <p class="text-sm text-gray-500 dark:text-gray-400">Nenhuma notificaÃ§Ã£o.</p>
        {% endif %}
      </div>

    </div>

    <!-- =============== DARK MODE BUTTON =============== -->
    <button @click="
        darkMode = !darkMode;
        document.documentElement.classList.toggle('dark');
        localStorage.theme = darkMode ? 'dark' : 'light';
      "
      class="text-xl px-3 py-2 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 transition">
      ğŸŒ“
    </button>

    <!-- =============== USER DROPDOWN =============== -->
    <div x-data="{ open: false }" class="relative">

      <!-- Avatar -->
      <button @click="open = !open"
        class="w-10 h-10 rounded-full bg-emerald-600 text-white flex items-center justify-center text-lg">
        {{ request.user.username|first|upper }}
      </button>

      <!-- Menu -->
      <div x-show="open" @click.outside="open = false" x-transition
        class="absolute right-0 mt-3 w-56 bg-white dark:bg-gray-800 shadow-lg border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden z-50">

        <div class="p-4">
          <p class="font-semibold text-gray-800 dark:text-gray-200">{{ request.user.username }}</p>
          <p class="text-xs text-gray-500 dark:text-gray-400">{{ request.user.role }}</p>
        </div>

        <div class="border-t dark:border-gray-700">

          <a href="/profile/"
            class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-emerald-50 dark:hover:bg-gray-700">
            ğŸ‘¤ Meu Perfil
          </a>

          <a href="/settings/"
            class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-emerald-50 dark:hover:bg-gray-700">
            âš™ï¸ ConfiguraÃ§Ãµes
          </a>

          <a href="/auth/logout/" class="block px-4 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-600/20">
            ğŸšª Sair
          </a>

        </div>

      </div>
    </div>

  </div>

</header>